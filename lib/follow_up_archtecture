lib/
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ config/          # Theme, constants, localization
â”‚   â”œâ”€â”€ network/         # API clients, interceptors
â”‚   â”œâ”€â”€ utils/           # Helpers, validators, extensions
â”‚   â””â”€â”€ services/        # Auth, Firebase, etc.
â”‚
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ models/          # Model classes (User, Agency, Package, etc.)
â”‚   â”œâ”€â”€ repositories/    # Abstractions and implementations
â”‚   â””â”€â”€ datasources/     # Remote & local data sources
â”‚
â”œâ”€â”€ domain/
â”‚   â”œâ”€â”€ entities/        # Pure business logic models
â”‚   â””â”€â”€ usecases/        # Application-specific business rules
â”‚
â”œâ”€â”€ presentation/
â”‚   â”œâ”€â”€ cubits/          # Cubits/States (organized by feature)
â”‚   â”œâ”€â”€ views/           # Screens (UI only)
â”‚   â”œâ”€â”€ widgets/         # Shared widgets
â”‚   â””â”€â”€ routes/          # Navigation and route handling
â”‚
â””â”€â”€ main.dart
import 'package:get/get.dart';
import '../../../domain/usecases/send_message_usecase.dart';

class MistralController extends GetxController {
  var responseText = "Type something and press Ask Mistral...".obs;
  var isLoading = false.obs;

  final SendMessageUseCase sendMessageUseCase;

  // Inject the use case via constructor
  MistralController(this.sendMessageUseCase);

  Future<bool> callMistral({
    required String prompt,
    required String language,
    required String tone,
    required String length,
  }) async {
    isLoading.value = true;
    responseText.value = "â³ Thinking...";

    // ğŸ“ Build instruction string for AI
    final instruction = """
Write an email in $language with a $tone tone and $length length.
Here is the user's draft content: "$prompt"
""";

    // ğŸš Decide maxTokens based on length
    final maxTokens = length.toLowerCase() == "short"
        ? 50
        : length.toLowerCase() == "medium"
            ? 100
            : 200;

    try {
      // âœ… Call the use case
      final aiResponse =
          await sendMessageUseCase(instruction, maxTokens: maxTokens);

      responseText.value = aiResponse;
      return true;
    } catch (e) {
      responseText.value = "âŒ Exception: $e";
      return false;
    } finally {
      isLoading.value = false;
    }
  }
}
